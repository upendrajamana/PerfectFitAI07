<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Analysis Dashboard - PerfectFitAI</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #2563eb;
            --secondary-blue: #1d4ed8;
            --accent-green: #10b981;
            --accent-orange: #f59e0b;
            --accent-red: #ef4444;
            --bg-white: #ffffff;
            --bg-gray: #f8fafc;
            --bg-sidebar: #f1f5f9;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --text-muted: #9ca3af;
            --border-light: #e5e7eb;
            --border-medium: #d1d5db;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-gray);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            font-weight: 400;
            -webkit-font-smoothing: antialiased;
        }

        /* Header */
        .header {
            background: var(--primary-blue);
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-md);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .logo {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-links a {
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s ease;
        }

        .nav-links a:hover {
            color: white;
        }

        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 280px 1fr 400px;
            gap: 0;
            max-width: 1400px;
            margin: 0 auto;
            min-height: calc(100vh - 80px);
            background: white;
            box-shadow: var(--shadow-lg);
        }

        /* Left Sidebar */
        .left-sidebar {
            background: var(--bg-sidebar);
            border-right: 1px solid var(--border-light);
            padding: 2rem 0;
            overflow-y: auto;
        }

        .score-section {
            padding: 0 2rem;
            margin-bottom: 2rem;
        }

        .overall-score {
            text-align: center;
            margin-bottom: 2rem;
        }

        .score-circle {
            position: relative;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .score-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: 3.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            display: block;
            letter-spacing: -0.02em;
        }

        .score-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .points-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--accent-green);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-top: 0.5rem;
        }

        .section-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 1rem;
            padding: 0 2rem;
        }

        .fixes-list {
            list-style: none;
        }

        .fix-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }

        .fix-item:hover {
            background: rgba(37, 99, 235, 0.05);
            border-left-color: var(--primary-blue);
        }

        .fix-item.active {
            background: rgba(37, 99, 235, 0.1);
            border-left-color: var(--primary-blue);
            color: var(--primary-blue);
        }

        .fix-item-content {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .fix-icon {
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
        }

        .fix-name {
            font-weight: 500;
        }

        .fix-score {
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600;
            font-size: 0.875rem;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            background: var(--bg-white);
            color: var(--text-primary);
        }

        .fix-score.high { background: #dcfce7; color: #166534; }
        .fix-score.medium { background: #fef3c7; color: #92400e; }
        .fix-score.low { background: #fee2e2; color: #991b1b; }

        /* Center Panel */
        .center-panel {
            padding: 2rem;
            overflow-y: auto;
            background: white;
        }

        .panel-header {
            margin-bottom: 2rem;
        }

        .panel-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .panel-subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.6;
        }

        .analysis-content {
            background: var(--bg-gray);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .analysis-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .analysis-icon {
            width: 48px;
            height: 48px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.25rem;
            font-weight: 600;
            color: white;
        }

        .analysis-info h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .analysis-score {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-light);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 1.5rem;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1.5s ease-out;
        }

        .feedback-text {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .improvement-tips {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid var(--primary-blue);
        }

        .improvement-tips h4 {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }

        .improvement-tips ul {
            list-style-type: disc;
            padding-left: 1.25rem;
        }

        .improvement-tips li {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
            line-height: 1.5;
        }

        /* Right Panel */
        .right-panel {
            background: white;
            border-left: 1px solid var(--border-light);
            padding: 2rem;
            overflow-y: auto;
        }

        .resume-preview {
            background: var(--bg-gray);
            border-radius: 12px;
            padding: 2rem;
            min-height: 600px;
            border: 2px dashed var(--border-medium);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-style: italic;
        }

        .job-description-section {
            margin-bottom: 2rem;
        }

        .job-description-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
        }

        .description-input {
            width: 100%;
            min-height: 120px;
            padding: 1rem;
            border: 2px solid var(--border-light);
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 0.875rem;
            line-height: 1.5;
            resize: vertical;
            transition: border-color 0.2s ease;
        }

        .description-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .analyze-btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 1rem;
            width: 100%;
        }

        .analyze-btn:hover {
            background: var(--secondary-blue);
        }

        /* Color schemes for different categories */
        .tailoring { background: var(--primary-blue); }
        .content { background: #7c3aed; }
        .order { background: var(--accent-green); }
        .presence { background: var(--accent-red); }

        .progress-fill.tailoring { background: var(--primary-blue); }
        .progress-fill.content { background: #7c3aed; }
        .progress-fill.order { background: var(--accent-green); }
        .progress-fill.presence { background: var(--accent-red); }

        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
                gap: 0;
            }

            .left-sidebar {
                display: none;
            }

            .right-panel {
                border-left: none;
                border-top: 1px solid var(--border-light);
            }
        }

        @media (max-width: 768px) {
            .nav-container {
                padding: 0 1rem;
            }

            .center-panel,
            .right-panel {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="nav-container">
            <a href="/" class="logo">PerfectFitAI</a>
        </div>
    </div>

    <div class="main-container">
        <!-- Left Sidebar -->
        <div class="left-sidebar">
            <div class="score-section">
                <div class="overall-score">
                    <div class="score-circle">
                        <span class="score-number" id="score-count">0</span>
                    </div>
                    <div class="score-label">Overall</div>
                    <div class="points-badge">
                        <span>↗</span>
                        <span id="points-gained">0 Points</span>
                    </div>
                </div>
            </div>

            <div class="section-title">Top Fixes</div>
            <ul class="fixes-list">
                <li class="fix-item active" data-section="tailoring" onclick="showSection('tailoring')">
                    <div class="fix-item-content">
                        <div class="fix-icon">🎯</div>
                        <div class="fix-name">Job Tailoring</div>
                    </div>
                    <div class="fix-score low" id="match-score">0</div>
                </li>
                <li class="fix-item" data-section="content" onclick="showSection('content')">
                    <div class="fix-item-content">
                        <div class="fix-icon">📝</div>
                        <div class="fix-name">Content Quality</div>
                    </div>
                    <div class="fix-score low" id="analysis-score">0</div>
                </li>
                <li class="fix-item" data-section="format" onclick="showSection('format')">
                    <div class="fix-item-content">
                        <div class="fix-icon">📋</div>
                        <div class="fix-name">Resume Format</div>
                    </div>
                    <div class="fix-score low" id="order-score">0</div>
                </li>
                <li class="fix-item" data-section="sections" onclick="showSection('sections')">
                    <div class="fix-item-content">
                        <div class="fix-icon">📄</div>
                        <div class="fix-name">Section Presence</div>
                    </div>
                    <div class="fix-score low" id="presence-score">0</div>
                </li>
                <li class="fix-item" data-section="quantify" onclick="showSection('quantify')">
                    <div class="fix-item-content">
                        <div class="fix-icon">📊</div>
                        <div class="fix-name">Quantify Impact</div>
                    </div>
                    <div class="fix-score low" id="quantify-score">0</div>
                </li>
                <li class="fix-item" data-section="length" onclick="showSection('length')">
                    <div class="fix-item-content">
                        <div class="fix-icon">📏</div>
                        <div class="fix-name">Resume Length</div>
                    </div>
                    <div class="fix-score low" id="length-score">0</div>
                </li>
                <li class="fix-item" data-section="unnecessary" onclick="showSection('unnecessary')">
                    <div class="fix-item-content">
                        <div class="fix-icon">🗑️</div>
                        <div class="fix-name">Unnecessary Sections</div>
                    </div>
                    <div class="fix-score low" id="unnecessary-score">0</div>
                </li>
                <li class="fix-item" data-section="contact" onclick="showSection('contact')">
                    <div class="fix-item-content">
                        <div class="fix-icon">📞</div>
                        <div class="fix-name">Contact Details</div>
                    </div>
                    <div class="fix-score low" id="contact-score">0</div>
                </li>
                <li class="fix-item" data-section="dates" onclick="showSection('dates')">
                    <div class="fix-item-content">
                        <div class="fix-icon">📅</div>
                        <div class="fix-name">Date Consistency</div>
                    </div>
                    <div class="fix-score low" id="dates-score">0</div>
                </li>
                <li class="fix-item" data-section="gaps" onclick="showSection('gaps')">
                    <div class="fix-item-content">
                        <div class="fix-icon">⏳</div>
                        <div class="fix-name">Experience Gaps</div>
                    </div>
                    <div class="fix-score low" id="gaps-score">0</div>
                </li>
            </ul>

            <div class="section-title" style="margin-top: 2rem;">🎯 Keyword & Role Match</div>
            <ul class="fixes-list">
                <li class="fix-item" data-section="keywords" onclick="showSection('keywords')">
                    <div class="fix-item-content">
                        <div class="fix-icon">🔍</div>
                        <div class="fix-name">Missing Keywords</div>
                    </div>
                    <div class="fix-score low" id="keywords-score">0</div>
                </li>
                <li class="fix-item" data-section="skills" onclick="showSection('skills')">
                    <div class="fix-item-content">
                        <div class="fix-icon">⚙️</div>
                        <div class="fix-name">Technical Skills</div>
                    </div>
                    <div class="fix-score low" id="skills-score">0</div>
                </li>
            </ul>

            <div class="section-title" style="margin-top: 2rem;">📢 Writing & Clarity</div>
            <ul class="fixes-list">
                <li class="fix-item" data-section="verbs" onclick="showSection('verbs')">
                    <div class="fix-item-content">
                        <div class="fix-icon">🚀</div>
                        <div class="fix-name">Action Verbs</div>
                    </div>
                    <div class="fix-score low" id="verbs-score">0</div>
                </li>
                <li class="fix-item" data-section="achievements" onclick="showSection('achievements')">
                    <div class="fix-item-content">
                        <div class="fix-icon">🏆</div>
                        <div class="fix-name">Achievements vs Tasks</div>
                    </div>
                    <div class="fix-score low" id="achievements-score">0</div>
                </li>
                <li class="fix-item" data-section="softskills" onclick="showSection('softskills')">
                    <div class="fix-item-content">
                        <div class="fix-icon">💭</div>
                        <div class="fix-name">Soft Skills Balance</div>
                    </div>
                    <div class="fix-score low" id="softskills-score">0</div>
                </li>
                <li class="fix-item" data-section="grammar" onclick="showSection('grammar')">
                    <div class="fix-item-content">
                        <div class="fix-icon">✏️</div>
                        <div class="fix-name">Grammar & Style</div>
                    </div>
                    <div class="fix-score low" id="grammar-score">0</div>
                </li>
            </ul>
        </div>

        <!-- Center Panel -->
        <div class="center-panel">
            <div class="panel-header">
                <h1 class="panel-title" id="panel-title">Job Tailoring Analysis</h1>
                <p class="panel-subtitle" id="panel-subtitle">Analyze how well your resume matches the job requirements and optimize keyword alignment.</p>
            </div>

            <div class="analysis-content" id="analysis-content">
                <div class="analysis-header">
                    <div class="analysis-icon tailoring" id="analysis-icon">🎯</div>
                    <div class="analysis-info">
                        <h3 id="analysis-title">Job Tailoring Score</h3>
                        <div class="analysis-score" id="analysis-score-display">0%</div>
                    </div>
                </div>

                <div class="progress-bar">
                    <div class="progress-fill tailoring" id="analysis-progress" style="width: 0%"></div>
                </div>

                <div class="feedback-text" id="feedback-text">
                    Upload your resume and job description to get detailed analysis and feedback.
                </div>

                <div class="improvement-tips">
                    <h4>Analysis will include:</h4>
                    <ul id="improvement-list">
                        <li>Keyword alignment with job requirements</li>
                        <li>Skills match assessment</li>
                        <li>Experience relevance analysis</li>
                        <li>Personalized improvement suggestions</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Right Panel -->
        <div class="right-panel">
            <div class="job-description-section">
                <h3>Get Tailored Insights</h3>
                <textarea
                    id="descriptionInput"
                    class="description-input"
                    placeholder="Paste job description here to receive personalized analysis..."
                ></textarea>
                <button class="analyze-btn" onclick="submitDescription()">Analyze Resume</button>
            </div>

            <div class="resume-preview">
                Resume analysis results loaded
            </div>
        </div>
    </div>

    <script>
        // Sample data for different sections (updated with your provided scores and feedback)
        const sectionData = {
            tailoring: {
                title: "Job Tailoring Analysis",
                subtitle: "Analyze how well your resume matches the job requirements and optimize keyword alignment.",
                icon: "🎯",
                iconClass: "tailoring",
                score: {{ match_score|default(0)|int }},
                feedback: `{{ match_feedback|default("Upload your resume and job description to get tailored analysis.")|safe }}`,
                improvements: [
                    "Include specific keywords from the job description",
                    "Highlight relevant experience that matches the job requirements",
                    "Quantify your achievements with specific numbers and metrics",
                    "Tailor your summary to match the role's key requirements"
                ]
            },
            content: {
                title: "Content Quality Assessment",
                subtitle: "Evaluate the quality, clarity, and impact of your resume content.",
                icon: "📝",
                iconClass: "content",
                score: {{ analysis_score|default(0)|int }},
                feedback: `{{ analysis_feedback|default("Content analysis will evaluate your resume's clarity, impact, and professional presentation.")|safe }}`,
                improvements: [
                    "Add quantified results to your achievements",
                    "Use stronger action verbs to describe your experiences",
                    "Ensure consistency in formatting and style",
                    "Consider adding more relevant technical skills"
                ]
            },
            format: {
                title: "Resume Format Analysis",
                subtitle: "Optimize the structure and flow of your resume sections for maximum impact.",
                icon: "📋",
                iconClass: "order",
                score: {{ (resume_order*10)|default(0)|int }},
                feedback: `{{ order_feedback|default("Format analysis will check your resume structure, section ordering, and visual presentation.")|safe }}`,
                improvements: [
                    "Optimize section ordering for your industry",
                    "Ensure consistent formatting throughout",
                    "Use appropriate spacing and margins",
                    "Choose professional fonts and layout"
                ]
            },
            sections: {
                title: "Section Presence Check",
                subtitle: "Ensure all essential resume sections are included and properly structured.",
                icon: "📄",
                iconClass: "presence",
                score: {{ presence_score|default(0)|int }},
                feedback: `{{ presence_feedback|default("Section analysis will verify all required sections are present and complete.")|safe }}`,
                improvements: [
                    "Include Professional Summary section",
                    "Add relevant certifications or courses",
                    "Include volunteer experience if relevant",
                    "Ensure contact information is complete and professional"
                ]
            },
            quantify: {
                title: "Quantify Impact",
                subtitle: "Are there numbers to support your achievements and make them more compelling?",
                icon: "📊",
                iconClass: "order",
                score: {{ quantify_score|default(0)|int }},
                feedback: `{{ quantify_feedback|default("Upload your resume to get quantification analysis.")|safe }}`,
                improvements: [
                    "Add percentages to show improvement or growth",
                    "Include dollar amounts for cost savings or revenue impact",
                    "Mention team sizes you've worked with or managed",
                    "Quantify timeframes and project scopes",
                    "Use specific numbers instead of vague terms"
                ]
            },
            length: {
                title: "Resume Length Analysis",
                subtitle: "Is your resume the optimal length for your experience level and industry?",
                icon: "📏",
                iconClass: "content",
                score: {{ length_score|default(0)|int }},
                feedback: `{{ length_feedback|default("Analysis will evaluate if your resume length is appropriate for your career stage.")|safe }}`,
                improvements: [
                    "Keep resume to 1-2 pages for most positions",
                    "Remove outdated or irrelevant information",
                    "Prioritize most recent and relevant experience",
                    "Use concise bullet points"
                ]
            },
            unnecessary: {
                title: "Unnecessary Sections",
                subtitle: "Remove outdated sections like 'References' or 'Objective' that waste valuable space.",
                icon: "🗑️",
                iconClass: "presence",
                score: {{ unnecessary_score|default(0)|int }},
                feedback: `{{ unnecessary_feedback|default("Upload your resume to check for unnecessary sections.")|safe }}`,
                improvements: [
                    "Continue maintaining clean, relevant sections",
                    "Keep focus on professional achievements",
                    "Avoid adding outdated sections in future updates",
                    "Maintain this excellent standard"
                ]
            },
            contact: {
                title: "Contact Details Check",
                subtitle: "Ensure your contact information is complete, professional, and up-to-date.",
                icon: "📞",
                iconClass: "tailoring",
                score: {{ contact_score|default(0)|int }},
                feedback: `{{ contact_feedback|default("Upload your resume to analyze contact details.")|safe }}`,
                improvements: [
                    "Maintain current professional format",
                    "Keep contact information up-to-date",
                    "Continue using professional email address",
                    "Excellent work on contact presentation"
                ]
            },
            dates: {
                title: "Date Consistency",
                subtitle: "Check for missing or inconsistent formatting of employment and education dates.",
                icon: "📅",
                iconClass: "order",
                score: {{ dates_score|default(0)|int }},
                feedback: `{{ dates_feedback|default("Upload your resume to check date consistency.")|safe }}`,
                improvements: [
                    "Double-check all dates are present",
                    "Use 'Present' for current positions",
                    "Maintain consistent MM/YYYY format",
                    "Verify chronological order is correct"
                ]
            },
            gaps: {
                title: "Experience Gaps",
                subtitle: "Identify and address unexplained gaps in your work history.",
                icon: "⏳",
                iconClass: "presence",
                score: {{ gaps_score|default(0)|int }},
                feedback: `{{ gaps_feedback|default("Upload your resume to check for experience gaps.")|safe }}`,
                improvements: [
                    "Address gaps longer than 6 months",
                    "Include relevant activities during gaps",
                    "Consider functional resume format if needed",
                    "Be prepared to explain gaps in interviews"
                ]
            },
            keywords: {
                title: "Missing Keywords",
                subtitle: "Identify important keywords from job descriptions that are missing from your resume.",
                icon: "🔍",
                iconClass: "tailoring",
                score: {{ keywords_score|default(0)|int }},
                feedback: `{{ keywords_feedback|default("Upload your resume to analyze keyword usage.")|safe }}`,
                improvements: [
                    "Include more industry-specific terminology",
                    "Add relevant technical skills from job descriptions",
                    "Use both acronyms and full terms (e.g., 'AI' and 'Artificial Intelligence')",
                    "Research common keywords in your target roles"
                ]
            },
            skills: {
                title: "Technical Skills Coverage",
                subtitle: "Ensure you're showcasing relevant tools, languages, and technical competencies.",
                icon: "⚙️",
                iconClass: "content",
                score: {{ skills_score|default(0)|int }},
                feedback: `{{ skills_feedback|default("Upload your resume to analyze technical skills.")|safe }}`,
                improvements: [
                    "List programming languages and frameworks",
                    "Include relevant software and tools",
                    "Add certifications and technical qualifications",
                    "Organize skills by category or proficiency"
                ]
            },
            verbs: {
                title: "Action Verbs Analysis",
                subtitle: "Check if your bullet points start with strong, impactful action verbs.",
                icon: "🚀",
                iconClass: "content",
                score: {{ verbs_score|default(0)|int }},
                feedback: `{{ verbs_feedback|default("Upload your resume to check action verbs.")|safe }}`,
                improvements: [
                    "Start bullet points with strong action verbs like 'Developed', 'Led', 'Implemented'",
                    "Avoid weak starts like 'Responsible for' or 'Worked on'",
                    "Use varied vocabulary throughout your resume",
                    "Choose verbs that show impact and leadership"
                ]
            },
            achievements: {
                title: "Achievements vs Responsibilities",
                subtitle: "Ensure you're highlighting achievements rather than just listing job duties.",
                icon: "🏆",
                iconClass: "order",
                score: {{ achievements_score|default(0)|int }},
                feedback: `{{ achievements_feedback|default("Upload your resume to analyze achievements vs tasks.")|safe }}`,
                improvements: [
                    "Transform duties into specific achievements",
                    "Show measurable impact of your work",
                    "Use the STAR method (Situation, Task, Action, Result)",
                    "Focus on what you accomplished, not just what you did"
                ]
            },
            softskills: {
                title: "Soft Skills Balance",
                subtitle: "Check for appropriate balance of soft skills without overloading with unproven claims.",
                icon: "💭",
                iconClass: "presence",
                score: {{ softskills_score|default(0)|int }},
                feedback: `{{ softskills_feedback|default("Upload your resume to check soft skills balance.")|safe }}`,
                improvements: [
                    "Demonstrate soft skills through examples",
                    "Avoid listing soft skills without proof",
                    "Integrate soft skills into achievement descriptions",
                    "Focus on skills relevant to the target role"
                ]
            },
            grammar: {
                title: "Grammar & Style Check",
                subtitle: "Identify typos, grammatical errors, and inconsistent writing style.",
                icon: "✏️",
                iconClass: "content",
                score: {{ grammar_score|default(0)|int }},
                feedback: `{{ grammar_feedback|default("Upload your resume to check grammar and style.")|safe }}`,
                improvements: [
                    "Proofread for spelling and grammar errors",
                    "Maintain consistent tense throughout",
                    "Use parallel structure in bullet points",
                    "Ensure professional tone and language"
                ]
            }
        };

        function toggleOptions(element) {
            const optionsList = element.querySelector('.options-list');
            const isExpanded = optionsList.classList.contains('expanded');

            document.querySelectorAll('.options-list.expanded').forEach(list => {
                if (list !== optionsList) {
                    list.classList.remove('expanded');
                }
            });

            if (isExpanded) {
                optionsList.classList.remove('expanded');
            } else {
                optionsList.classList.add('expanded');
            }
        }

        function submitDescription() {
            const description = document.getElementById('descriptionInput').value;
            if (description.trim()) {
                console.log('Analyzing job description:', description);

                const btn = document.querySelector('.analyze-btn');
                const originalText = btn.textContent;
                btn.textContent = 'Analyzing...';
                btn.disabled = true;

                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.disabled = false;
                    // Update scores after analysis
                    updateScores();
                }, 2000);
            } else {
                alert('Please paste a job description first.');
            }
        }

        function updateScores() {
            const scores = {
                'match-score': {{ match_score|default(0)|int }},
                'analysis-score': {{ analysis_score|default(0)|int }},
                'order-score': {{ (resume_order*10)|default(0)|int }},
                'presence-score': {{ presence_score|default(0)|int }},
                'quantify-score': {{ quantify_score|default(0)|int }},
                'length-score': {{ length_score|default(0)|int }},
                'unnecessary-score': {{ unnecessary_score|default(0)|int }},
                'contact-score': {{ contact_score|default(0)|int }},
                'dates-score': {{ dates_score|default(0)|int }},
                'gaps-score': {{ gaps_score|default(0)|int }},
                'keywords-score': {{ keywords_score|default(0)|int }},
                'skills-score': {{ skills_score|default(0)|int }},
                'verbs-score': {{ verbs_score|default(0)|int }},
                'achievements-score': {{ achievements_score|default(0)|int }},
                'softskills-score': {{ softskills_score|default(0)|int }},
                'grammar-score': {{ grammar_score|default(0)|int }}
            };

            let total = 0;
            let count = 0;

            for (const id in scores) {
                const score = scores[id];

                // Count all scores for average (including zeros for sections that were analyzed)
                total += score;
                count++;

                // Update score number in sidebar
                const scoreElement = document.getElementById(id);
                if (scoreElement) {
                    scoreElement.textContent = score;
                    // Update score class
                    scoreElement.className = 'fix-score ' + getScoreClass(score);
                }
            }

            // Use the total_score from backend if available, otherwise calculate average
            const totalScore = {{ total_score|default(0)|int }} || (count > 0 ? Math.round(total / count) : 0);
            document.getElementById('score-count').textContent = totalScore;
            document.getElementById('points-gained').textContent = totalScore + ' Points';

            // Refresh current section display
            const activeSection = document.querySelector('.fix-item.active');
            if (activeSection) {
                showSection(activeSection.dataset.section);
            }
        }

        function showSection(sectionKey) {
            // Update active state
            document.querySelectorAll('.fix-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionKey}"]`).classList.add('active');

            // Get section data
            const section = sectionData[sectionKey];
            if (!section) return;

            // Update panel content
            document.getElementById('panel-title').textContent = section.title;
            document.getElementById('panel-subtitle').textContent = section.subtitle;
            document.getElementById('analysis-icon').textContent = section.icon;
            document.getElementById('analysis-icon').className = `analysis-icon ${section.iconClass}`;
            document.getElementById('analysis-title').textContent = section.title.split(' ').slice(0, -1).join(' ') + ' Score';
            document.getElementById('analysis-score-display').textContent = section.score + '%';
            document.getElementById('analysis-progress').style.width = section.score + '%';
            document.getElementById('analysis-progress').className = `progress-fill ${section.iconClass}`;
            document.getElementById('feedback-text').textContent = section.feedback;

            // Update improvement list
            const improvementList = document.getElementById('improvement-list');
            improvementList.innerHTML = '';
            section.improvements.forEach(improvement => {
                const li = document.createElement('li');
                li.textContent = improvement;
                improvementList.appendChild(li);
            });
        }

        function getScoreClass(score) {
            if (score >= 80) return 'high';
            if (score >= 60) return 'medium';
            return 'low';
        }

        // Initialize with tailoring section
        document.addEventListener('DOMContentLoaded', function() {
            showSection('tailoring');
            // Run initial update to load the scores
            updateScores();
        });
    </script>
</body>
</html>